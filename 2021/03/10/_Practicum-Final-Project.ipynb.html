<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Interconnect DS Project | DS projects</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Interconnect DS Project" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Welcome to the Data Science blog by Kritina Pluzharova" />
<meta property="og:description" content="Welcome to the Data Science blog by Kritina Pluzharova" />
<link rel="canonical" href="https://pluzharovakp.github.io/ds_projects/2021/03/10/_Practicum-Final-Project.ipynb.html" />
<meta property="og:url" content="https://pluzharovakp.github.io/ds_projects/2021/03/10/_Practicum-Final-Project.ipynb.html" />
<meta property="og:site_name" content="DS projects" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-03-10T00:00:00-06:00" />
<script type="application/ld+json">
{"url":"https://pluzharovakp.github.io/ds_projects/2021/03/10/_Practicum-Final-Project.ipynb.html","@type":"BlogPosting","headline":"Interconnect DS Project","dateModified":"2021-03-10T00:00:00-06:00","datePublished":"2021-03-10T00:00:00-06:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://pluzharovakp.github.io/ds_projects/2021/03/10/_Practicum-Final-Project.ipynb.html"},"description":"Welcome to the Data Science blog by Kritina Pluzharova","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/ds_projects/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://pluzharovakp.github.io/ds_projects/feed.xml" title="DS projects" /><link rel="shortcut icon" type="image/x-icon" href="/ds_projects/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/ds_projects/">DS projects</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/ds_projects/about/">About Me</a><a class="page-link" href="/ds_projects/search/">Search</a><a class="page-link" href="/ds_projects/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Interconnect DS Project</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-03-10T00:00:00-06:00" itemprop="datePublished">
        Mar 10, 2021
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      18 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/pluzharovakp/ds_projects/tree/master/_notebooks/2021-03-10-_Practicum-Final-Project.ipynb.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/ds_projects/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/pluzharovakp/ds_projects/master?filepath=_notebooks%2F2021-03-10-_Practicum-Final-Project.ipynb.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/ds_projects/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/pluzharovakp/ds_projects/blob/master/_notebooks/2021-03-10-_Practicum-Final-Project.ipynb.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/ds_projects/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-03-10-_Practicum-Final-Project.ipynb.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Project-Description">Project Description<a class="anchor-link" href="#Project-Description"> </a></h1><p>The telecom operator Interconnect would like to be able to forecast their churn of clients. If it's discovered that a user is planning to leave, they will be offered promotional codes and special plan options. Interconnect's marketing team has collected some of their clientele's personal data, including information about their plans and contracts.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Plan"><strong>Plan</strong><a class="anchor-link" href="#Plan"> </a></h1><ol>
<li><a href="#Data-Preprocessing">Data Preprocessing</a><ul>
<li>Look at the data</li>
<li>Change data types</li>
<li>Join the tables</li>
<li>Make decition about NaN values</li>
</ul>
</li>
<li><a href="#EDA">EDA</a><ul>
<li>Figure out what data is more relevant for prediction task and what is the target value</li>
<li>Try to find some pattern or new info that can be used</li>
</ul>
</li>
<li><a href="#Model-Training">Models training</a><ul>
<li>Use cross-validation for better traning</li>
<li>Hyperparameter tuning</li>
<li>Choose the best model rest on the choosen metric (AUC-ROC)</li>
</ul>
</li>
<li><a href="#Test-the-model">Test the model</a></li>
<li><a href="#Solution-Report">Conclusion</a> </li>
</ol>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>pip3 install catboost
</pre></div>

    </div>
</div>
</div>
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Output" data-close="Show Output"></summary>
        <p>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Collecting catboost
  Downloading https://files.pythonhosted.org/packages/96/3b/bb419654adcf7efff42ed8a3f84e50c8f236424b7ed1cc8ccd290852e003/catboost-0.24.4-cp37-none-manylinux1_x86_64.whl (65.7MB)
     |████████████████████████████████| 65.7MB 71kB/s 
Requirement already satisfied: pandas&gt;=0.24.0 in /usr/local/lib/python3.7/dist-packages (from catboost) (1.1.5)
Requirement already satisfied: numpy&gt;=1.16.0 in /usr/local/lib/python3.7/dist-packages (from catboost) (1.19.5)
Requirement already satisfied: scipy in /usr/local/lib/python3.7/dist-packages (from catboost) (1.4.1)
Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from catboost) (1.15.0)
Requirement already satisfied: graphviz in /usr/local/lib/python3.7/dist-packages (from catboost) (0.10.1)
Requirement already satisfied: matplotlib in /usr/local/lib/python3.7/dist-packages (from catboost) (3.2.2)
Requirement already satisfied: plotly in /usr/local/lib/python3.7/dist-packages (from catboost) (4.4.1)
Requirement already satisfied: pytz&gt;=2017.2 in /usr/local/lib/python3.7/dist-packages (from pandas&gt;=0.24.0-&gt;catboost) (2018.9)
Requirement already satisfied: python-dateutil&gt;=2.7.3 in /usr/local/lib/python3.7/dist-packages (from pandas&gt;=0.24.0-&gt;catboost) (2.8.1)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;catboost) (1.3.1)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;catboost) (0.10.0)
Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,&gt;=2.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;catboost) (2.4.7)
Requirement already satisfied: retrying&gt;=1.3.3 in /usr/local/lib/python3.7/dist-packages (from plotly-&gt;catboost) (1.3.3)
Installing collected packages: catboost
Successfully installed catboost-0.24.4
</pre>
</div>
</div>

</div>
</div>
</p>
    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">lightgbm</span> <span class="kn">import</span> <span class="n">LGBMRegressor</span><span class="p">,</span> <span class="n">cv</span><span class="p">,</span> <span class="n">Dataset</span>
<span class="kn">from</span> <span class="nn">catboost</span> <span class="kn">import</span> <span class="n">Pool</span><span class="p">,</span> <span class="n">CatBoostRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_auc_score</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OrdinalEncoder</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">LabelEncoder</span><span class="p">,</span> <span class="n">OneHotEncoder</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">make_scorer</span>
<span class="kn">from</span> <span class="nn">sklearn.dummy</span> <span class="kn">import</span> <span class="n">DummyRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">GradientBoostingRegressor</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Data-Preprocessing"><strong>Data Preprocessing</strong><a class="anchor-link" href="#Data-Preprocessing"> </a></h1>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">contract</span> <span class="o">=</span>  <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path_to_contract</span><span class="p">)</span>
<span class="n">internet</span> <span class="o">=</span>  <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path_to_internet</span><span class="p">)</span>
<span class="n">personal</span> <span class="o">=</span>  <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path_to_personal</span><span class="p">)</span>
<span class="n">phone</span> <span class="o">=</span>  <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path_to_phone</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">contract</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 7043 entries, 0 to 7042
Data columns (total 8 columns):
 #   Column            Non-Null Count  Dtype  
---  ------            --------------  -----  
 0   customerID        7043 non-null   object 
 1   BeginDate         7043 non-null   object 
 2   EndDate           7043 non-null   object 
 3   Type              7043 non-null   object 
 4   PaperlessBilling  7043 non-null   object 
 5   PaymentMethod     7043 non-null   object 
 6   MonthlyCharges    7043 non-null   float64
 7   TotalCharges      7043 non-null   object 
dtypes: float64(1), object(7)
memory usage: 440.3+ KB
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">internet</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 5517 entries, 0 to 5516
Data columns (total 8 columns):
 #   Column            Non-Null Count  Dtype 
---  ------            --------------  ----- 
 0   customerID        5517 non-null   object
 1   InternetService   5517 non-null   object
 2   OnlineSecurity    5517 non-null   object
 3   OnlineBackup      5517 non-null   object
 4   DeviceProtection  5517 non-null   object
 5   TechSupport       5517 non-null   object
 6   StreamingTV       5517 non-null   object
 7   StreamingMovies   5517 non-null   object
dtypes: object(8)
memory usage: 344.9+ KB
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">personal</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 7043 entries, 0 to 7042
Data columns (total 5 columns):
 #   Column         Non-Null Count  Dtype 
---  ------         --------------  ----- 
 0   customerID     7043 non-null   object
 1   gender         7043 non-null   object
 2   SeniorCitizen  7043 non-null   int64 
 3   Partner        7043 non-null   object
 4   Dependents     7043 non-null   object
dtypes: int64(1), object(4)
memory usage: 275.2+ KB
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">phone</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 6361 entries, 0 to 6360
Data columns (total 2 columns):
 #   Column         Non-Null Count  Dtype 
---  ------         --------------  ----- 
 0   customerID     6361 non-null   object
 1   MultipleLines  6361 non-null   object
dtypes: object(2)
memory usage: 99.5+ KB
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">contract</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Output" data-close="Show Output"></summary>
        <p>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customerID</th>
      <th>BeginDate</th>
      <th>EndDate</th>
      <th>Type</th>
      <th>PaperlessBilling</th>
      <th>PaymentMethod</th>
      <th>MonthlyCharges</th>
      <th>TotalCharges</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7590-VHVEG</td>
      <td>2020-01-01</td>
      <td>No</td>
      <td>Month-to-month</td>
      <td>Yes</td>
      <td>Electronic check</td>
      <td>29.85</td>
      <td>29.85</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5575-GNVDE</td>
      <td>2017-04-01</td>
      <td>No</td>
      <td>One year</td>
      <td>No</td>
      <td>Mailed check</td>
      <td>56.95</td>
      <td>1889.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3668-QPYBK</td>
      <td>2019-10-01</td>
      <td>2019-12-01 00:00:00</td>
      <td>Month-to-month</td>
      <td>Yes</td>
      <td>Mailed check</td>
      <td>53.85</td>
      <td>108.15</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7795-CFOCW</td>
      <td>2016-05-01</td>
      <td>No</td>
      <td>One year</td>
      <td>No</td>
      <td>Bank transfer (automatic)</td>
      <td>42.30</td>
      <td>1840.75</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9237-HQITU</td>
      <td>2019-09-01</td>
      <td>2019-11-01 00:00:00</td>
      <td>Month-to-month</td>
      <td>Yes</td>
      <td>Electronic check</td>
      <td>70.70</td>
      <td>151.65</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>
</p>
    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">internet</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Output" data-close="Show Output"></summary>
        <p>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customerID</th>
      <th>InternetService</th>
      <th>OnlineSecurity</th>
      <th>OnlineBackup</th>
      <th>DeviceProtection</th>
      <th>TechSupport</th>
      <th>StreamingTV</th>
      <th>StreamingMovies</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7590-VHVEG</td>
      <td>DSL</td>
      <td>No</td>
      <td>Yes</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5575-GNVDE</td>
      <td>DSL</td>
      <td>Yes</td>
      <td>No</td>
      <td>Yes</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3668-QPYBK</td>
      <td>DSL</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7795-CFOCW</td>
      <td>DSL</td>
      <td>Yes</td>
      <td>No</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9237-HQITU</td>
      <td>Fiber optic</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>
</p>
    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">personal</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Output" data-close="Show Output"></summary>
        <p>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customerID</th>
      <th>gender</th>
      <th>SeniorCitizen</th>
      <th>Partner</th>
      <th>Dependents</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7590-VHVEG</td>
      <td>Female</td>
      <td>0</td>
      <td>Yes</td>
      <td>No</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5575-GNVDE</td>
      <td>Male</td>
      <td>0</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3668-QPYBK</td>
      <td>Male</td>
      <td>0</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7795-CFOCW</td>
      <td>Male</td>
      <td>0</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9237-HQITU</td>
      <td>Female</td>
      <td>0</td>
      <td>No</td>
      <td>No</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>
</p>
    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">phone</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Output" data-close="Show Output"></summary>
        <p>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customerID</th>
      <th>MultipleLines</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5575-GNVDE</td>
      <td>No</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3668-QPYBK</td>
      <td>No</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9237-HQITU</td>
      <td>No</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9305-CDSKC</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1452-KIOVK</td>
      <td>Yes</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>
</p>
    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">internet</span><span class="p">[</span><span class="s1">&#39;FiberOptic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">internet</span><span class="p">[</span><span class="s1">&#39;InternetService&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Fiber optic&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">internet</span> <span class="o">=</span> <span class="n">internet</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;InternetService&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">contract</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">phone</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;customerID&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">internet</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;customerID&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">personal</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;customerID&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customerID</th>
      <th>BeginDate</th>
      <th>EndDate</th>
      <th>Type</th>
      <th>PaperlessBilling</th>
      <th>PaymentMethod</th>
      <th>MonthlyCharges</th>
      <th>TotalCharges</th>
      <th>MultipleLines</th>
      <th>OnlineSecurity</th>
      <th>OnlineBackup</th>
      <th>DeviceProtection</th>
      <th>TechSupport</th>
      <th>StreamingTV</th>
      <th>StreamingMovies</th>
      <th>FiberOptic</th>
      <th>gender</th>
      <th>SeniorCitizen</th>
      <th>Partner</th>
      <th>Dependents</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7590-VHVEG</td>
      <td>2020-01-01</td>
      <td>No</td>
      <td>Month-to-month</td>
      <td>Yes</td>
      <td>Electronic check</td>
      <td>29.85</td>
      <td>29.85</td>
      <td>NaN</td>
      <td>No</td>
      <td>Yes</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>0.0</td>
      <td>Female</td>
      <td>0</td>
      <td>Yes</td>
      <td>No</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5575-GNVDE</td>
      <td>2017-04-01</td>
      <td>No</td>
      <td>One year</td>
      <td>No</td>
      <td>Mailed check</td>
      <td>56.95</td>
      <td>1889.5</td>
      <td>No</td>
      <td>Yes</td>
      <td>No</td>
      <td>Yes</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>0.0</td>
      <td>Male</td>
      <td>0</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3668-QPYBK</td>
      <td>2019-10-01</td>
      <td>2019-12-01 00:00:00</td>
      <td>Month-to-month</td>
      <td>Yes</td>
      <td>Mailed check</td>
      <td>53.85</td>
      <td>108.15</td>
      <td>No</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>0.0</td>
      <td>Male</td>
      <td>0</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7795-CFOCW</td>
      <td>2016-05-01</td>
      <td>No</td>
      <td>One year</td>
      <td>No</td>
      <td>Bank transfer (automatic)</td>
      <td>42.30</td>
      <td>1840.75</td>
      <td>NaN</td>
      <td>Yes</td>
      <td>No</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>No</td>
      <td>No</td>
      <td>0.0</td>
      <td>Male</td>
      <td>0</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9237-HQITU</td>
      <td>2019-09-01</td>
      <td>2019-11-01 00:00:00</td>
      <td>Month-to-month</td>
      <td>Yes</td>
      <td>Electronic check</td>
      <td>70.70</td>
      <td>151.65</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>1.0</td>
      <td>Female</td>
      <td>0</td>
      <td>No</td>
      <td>No</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;TotalCharges&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;TotalCharges&#39;</span><span class="p">],</span><span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;TotalCharges&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;TotalCharges&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;MultipleLines&#39;</span><span class="p">,</span> <span class="s1">&#39;OnlineSecurity&#39;</span><span class="p">,</span> <span class="s1">&#39;OnlineBackup&#39;</span><span class="p">,</span> <span class="s1">&#39;DeviceProtection&#39;</span><span class="p">,</span> <span class="s1">&#39;TechSupport&#39;</span><span class="p">,</span> <span class="s1">&#39;StreamingTV&#39;</span><span class="p">,</span> 
           <span class="s1">&#39;StreamingMovies&#39;</span><span class="p">,</span> <span class="s1">&#39;FiberOptic&#39;</span><span class="p">,</span> <span class="s1">&#39;SeniorCitizen&#39;</span><span class="p">,</span> <span class="s1">&#39;PaperlessBilling&#39;</span><span class="p">,</span> <span class="s1">&#39;Partner&#39;</span><span class="p">,</span>	<span class="s1">&#39;Dependents&#39;</span><span class="p">,</span> <span class="s1">&#39;TotalCharges&#39;</span><span class="p">,</span><span class="s1">&#39;MonthlyCharges&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
  <span class="n">df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;No&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
  <span class="n">df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Yes&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
  <span class="n">df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span>  <span class="n">df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
  <span class="n">df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BeginDate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BeginDate&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Woman&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Female&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Need to explore ex-users and find something common between them.</p>
<p>For client who didn't exist in phone or internet tables NaN values should be fiiled with False value or 0 in the case. Probably they didn't use those services.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="EDA"><strong>EDA</strong><a class="anchor-link" href="#EDA"> </a></h1>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;EndDate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>No                     5174
2019-11-01 00:00:00     485
2019-12-01 00:00:00     466
2020-01-01 00:00:00     460
2019-10-01 00:00:00     458
Name: EndDate, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">current_users</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;EndDate&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;No&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ex_users</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;EndDate&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;No&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ex_users</span><span class="p">[</span><span class="s1">&#39;BeginDate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ex_users</span><span class="p">[</span><span class="s1">&#39;BeginDate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>
<span class="n">current_users</span><span class="p">[</span><span class="s1">&#39;BeginDate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_users</span><span class="p">[</span><span class="s1">&#39;BeginDate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>
</pre></div>

    </div>
</div>
</div>
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Output" data-close="Show Output"></summary>
        <p>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:1: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  &#34;&#34;&#34;Entry point for launching an IPython kernel.
/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  
</pre>
</div>
</div>

</div>
</div>
</p>
    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ex_users</span><span class="p">[</span><span class="s1">&#39;BeginDate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff9c9338dd0&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are a lot of new users from 2019 year who probably decided to try, but the service didn't sute them for some reason.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">arg_difference</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Ex-Users&#39;</span><span class="p">:</span> <span class="n">ex_users</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="s1">&#39;Current-Users&#39;</span><span class="p">:</span> <span class="n">current_users</span><span class="o">.</span><span class="n">mean</span><span class="p">()}</span>
<span class="n">arg_difference_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">arg_difference</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">arg_difference_df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ex-Users</th>
      <th>Current-Users</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BeginDate</th>
      <td>2017.834671</td>
      <td>2016.533243</td>
    </tr>
    <tr>
      <th>PaperlessBilling</th>
      <td>0.749064</td>
      <td>0.535562</td>
    </tr>
    <tr>
      <th>MonthlyCharges</th>
      <td>73.979668</td>
      <td>60.797835</td>
    </tr>
    <tr>
      <th>TotalCharges</th>
      <td>1531.323167</td>
      <td>2549.443564</td>
    </tr>
    <tr>
      <th>MultipleLines</th>
      <td>0.454789</td>
      <td>0.409934</td>
    </tr>
    <tr>
      <th>OnlineSecurity</th>
      <td>0.157838</td>
      <td>0.333204</td>
    </tr>
    <tr>
      <th>OnlineBackup</th>
      <td>0.279829</td>
      <td>0.368380</td>
    </tr>
    <tr>
      <th>DeviceProtection</th>
      <td>0.291600</td>
      <td>0.362775</td>
    </tr>
    <tr>
      <th>TechSupport</th>
      <td>0.165864</td>
      <td>0.335137</td>
    </tr>
    <tr>
      <th>StreamingTV</th>
      <td>0.435527</td>
      <td>0.365868</td>
    </tr>
    <tr>
      <th>StreamingMovies</th>
      <td>0.437667</td>
      <td>0.369927</td>
    </tr>
    <tr>
      <th>FiberOptic</th>
      <td>0.693954</td>
      <td>0.347700</td>
    </tr>
    <tr>
      <th>SeniorCitizen</th>
      <td>0.254682</td>
      <td>0.128721</td>
    </tr>
    <tr>
      <th>Partner</th>
      <td>0.357945</td>
      <td>0.528218</td>
    </tr>
    <tr>
      <th>Dependents</th>
      <td>0.174425</td>
      <td>0.344801</td>
    </tr>
    <tr>
      <th>Woman</th>
      <td>0.502408</td>
      <td>0.492656</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ex_users</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;BeginDate&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PaperlessBilling</th>
      <th>MonthlyCharges</th>
      <th>TotalCharges</th>
      <th>MultipleLines</th>
      <th>OnlineSecurity</th>
      <th>OnlineBackup</th>
      <th>DeviceProtection</th>
      <th>TechSupport</th>
      <th>StreamingTV</th>
      <th>StreamingMovies</th>
      <th>FiberOptic</th>
      <th>SeniorCitizen</th>
      <th>Partner</th>
      <th>Dependents</th>
      <th>Woman</th>
    </tr>
    <tr>
      <th>BeginDate</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013</th>
      <td>0.750000</td>
      <td>100.125000</td>
      <td>7137.750000</td>
      <td>1.000000</td>
      <td>0.625000</td>
      <td>0.625000</td>
      <td>0.875000</td>
      <td>0.750000</td>
      <td>0.875000</td>
      <td>0.875000</td>
      <td>0.750000</td>
      <td>0.250000</td>
      <td>0.875000</td>
      <td>0.250000</td>
      <td>0.500000</td>
    </tr>
    <tr>
      <th>2014</th>
      <td>0.775510</td>
      <td>95.724490</td>
      <td>6316.387755</td>
      <td>0.826531</td>
      <td>0.326531</td>
      <td>0.734694</td>
      <td>0.663265</td>
      <td>0.387755</td>
      <td>0.836735</td>
      <td>0.846939</td>
      <td>0.846939</td>
      <td>0.255102</td>
      <td>0.724490</td>
      <td>0.295918</td>
      <td>0.367347</td>
    </tr>
    <tr>
      <th>2015</th>
      <td>0.756098</td>
      <td>88.000000</td>
      <td>4646.040650</td>
      <td>0.747967</td>
      <td>0.325203</td>
      <td>0.560976</td>
      <td>0.512195</td>
      <td>0.243902</td>
      <td>0.731707</td>
      <td>0.699187</td>
      <td>0.796748</td>
      <td>0.308943</td>
      <td>0.601626</td>
      <td>0.203252</td>
      <td>0.471545</td>
    </tr>
    <tr>
      <th>2016</th>
      <td>0.813793</td>
      <td>83.882759</td>
      <td>3441.834483</td>
      <td>0.600000</td>
      <td>0.262069</td>
      <td>0.475862</td>
      <td>0.510345</td>
      <td>0.317241</td>
      <td>0.613793</td>
      <td>0.627586</td>
      <td>0.744828</td>
      <td>0.365517</td>
      <td>0.482759</td>
      <td>0.172414</td>
      <td>0.503448</td>
    </tr>
    <tr>
      <th>2017</th>
      <td>0.804020</td>
      <td>82.884422</td>
      <td>2375.693467</td>
      <td>0.643216</td>
      <td>0.190955</td>
      <td>0.381910</td>
      <td>0.361809</td>
      <td>0.185930</td>
      <td>0.537688</td>
      <td>0.562814</td>
      <td>0.824121</td>
      <td>0.331658</td>
      <td>0.492462</td>
      <td>0.236181</td>
      <td>0.532663</td>
    </tr>
    <tr>
      <th>2018</th>
      <td>0.790476</td>
      <td>78.352381</td>
      <td>1254.796825</td>
      <td>0.517460</td>
      <td>0.187302</td>
      <td>0.269841</td>
      <td>0.314286</td>
      <td>0.190476</td>
      <td>0.498413</td>
      <td>0.501587</td>
      <td>0.752381</td>
      <td>0.279365</td>
      <td>0.387302</td>
      <td>0.184127</td>
      <td>0.517460</td>
    </tr>
    <tr>
      <th>2019</th>
      <td>0.711519</td>
      <td>65.162080</td>
      <td>252.173293</td>
      <td>0.296636</td>
      <td>0.084608</td>
      <td>0.149847</td>
      <td>0.168196</td>
      <td>0.094801</td>
      <td>0.287462</td>
      <td>0.286442</td>
      <td>0.612640</td>
      <td>0.207951</td>
      <td>0.231397</td>
      <td>0.142712</td>
      <td>0.508665</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">current_users</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;BeginDate&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PaperlessBilling</th>
      <th>MonthlyCharges</th>
      <th>TotalCharges</th>
      <th>MultipleLines</th>
      <th>OnlineSecurity</th>
      <th>OnlineBackup</th>
      <th>DeviceProtection</th>
      <th>TechSupport</th>
      <th>StreamingTV</th>
      <th>StreamingMovies</th>
      <th>FiberOptic</th>
      <th>SeniorCitizen</th>
      <th>Partner</th>
      <th>Dependents</th>
      <th>Woman</th>
    </tr>
    <tr>
      <th>BeginDate</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2014</th>
      <td>0.581059</td>
      <td>74.090690</td>
      <td>5121.858748</td>
      <td>0.662921</td>
      <td>0.542536</td>
      <td>0.605939</td>
      <td>0.600321</td>
      <td>0.539326</td>
      <td>0.561798</td>
      <td>0.570626</td>
      <td>0.418941</td>
      <td>0.155698</td>
      <td>0.763242</td>
      <td>0.413323</td>
      <td>0.483949</td>
    </tr>
    <tr>
      <th>2015</th>
      <td>0.578875</td>
      <td>67.499314</td>
      <td>3785.851852</td>
      <td>0.508916</td>
      <td>0.393690</td>
      <td>0.462277</td>
      <td>0.452675</td>
      <td>0.406036</td>
      <td>0.462277</td>
      <td>0.475995</td>
      <td>0.407407</td>
      <td>0.153635</td>
      <td>0.639232</td>
      <td>0.370370</td>
      <td>0.511660</td>
    </tr>
    <tr>
      <th>2016</th>
      <td>0.550162</td>
      <td>62.250809</td>
      <td>2746.218447</td>
      <td>0.428803</td>
      <td>0.330097</td>
      <td>0.385113</td>
      <td>0.399676</td>
      <td>0.317152</td>
      <td>0.401294</td>
      <td>0.401294</td>
      <td>0.364078</td>
      <td>0.119741</td>
      <td>0.548544</td>
      <td>0.360841</td>
      <td>0.525890</td>
    </tr>
    <tr>
      <th>2017</th>
      <td>0.518576</td>
      <td>60.730650</td>
      <td>1913.739938</td>
      <td>0.380805</td>
      <td>0.297214</td>
      <td>0.329721</td>
      <td>0.349845</td>
      <td>0.326625</td>
      <td>0.349845</td>
      <td>0.345201</td>
      <td>0.362229</td>
      <td>0.147059</td>
      <td>0.487616</td>
      <td>0.329721</td>
      <td>0.470588</td>
    </tr>
    <tr>
      <th>2018</th>
      <td>0.511888</td>
      <td>54.158042</td>
      <td>1074.416783</td>
      <td>0.309091</td>
      <td>0.236364</td>
      <td>0.236364</td>
      <td>0.236364</td>
      <td>0.237762</td>
      <td>0.261538</td>
      <td>0.254545</td>
      <td>0.318881</td>
      <td>0.114685</td>
      <td>0.446154</td>
      <td>0.335664</td>
      <td>0.492308</td>
    </tr>
    <tr>
      <th>2019</th>
      <td>0.498975</td>
      <td>48.607582</td>
      <td>347.054303</td>
      <td>0.175205</td>
      <td>0.177254</td>
      <td>0.178279</td>
      <td>0.148566</td>
      <td>0.170082</td>
      <td>0.184426</td>
      <td>0.191598</td>
      <td>0.267418</td>
      <td>0.099385</td>
      <td>0.309426</td>
      <td>0.272541</td>
      <td>0.501025</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>0.397541</td>
      <td>37.610656</td>
      <td>35.766393</td>
      <td>0.086066</td>
      <td>0.094262</td>
      <td>0.081967</td>
      <td>0.049180</td>
      <td>0.094262</td>
      <td>0.061475</td>
      <td>0.065574</td>
      <td>0.131148</td>
      <td>0.049180</td>
      <td>0.168033</td>
      <td>0.233607</td>
      <td>0.422131</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Conclution-of-EDA:"><strong>Conclution of EDA:</strong><a class="anchor-link" href="#Conclution-of-EDA:"> </a></h3><p>Our ex-clients usually had internet with Fiber Optic, used Streaming TV and Streaming Movies and as an obvious fact paid more.
They also less used Tech Support, more of them used Multiple Lines of the phone and there are more SeniorCitizen among ex-users.</p>
<p>Partner and Gender information don't seem to be relevant, but Dependents can be as there are some difference by this parameter.</p>
<p>Most of the ex-users came to us in 2019 year.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Questions:"><strong>Questions:</strong><a class="anchor-link" href="#Questions:"> </a></h3><ol>
<li>What do Partner and Dependents columns mean? Are they relevant? </li>
<li>What the most relevant columns would be the best to take as the features for machine leaning model?</li>
<li>What is the target value?</li>
<li>It is a classification task: whether or not the user will quit, isn't it?</li>
<li>What metric to use?</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our target column is EndDate. As far as it should has boolean type (with us or not), so the column values should be changed.</p>
<p>It's better to remain all features as all of them can be relevant to the customer decision to leave or to stay.</p>
<p>It is a classification task, but Logistic regression can be used as there are only two target options.</p>
<p>AUC-ROC metric should be used here to find the best model, because our data is unballanced and it needs to take in account the rate of false-positive and false-negative values.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Model-Training"><strong>Model Training</strong><a class="anchor-link" href="#Model-Training"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Creating-Features">Creating Features<a class="anchor-link" href="#Creating-Features"> </a></h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;IsClient&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;EndDate&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;No&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;EndDate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;EndDate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;EndDate&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;No&#39;</span><span class="p">,</span> <span class="s2">&quot;2020-02-01&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;EndDate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;EndDate&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;AllTime&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;EndDate&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;BeginDate&#39;</span><span class="p">])</span> 
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;AllTime&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;AllTime&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;M&quot;</span><span class="p">))</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;AllTime&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;AllTime&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customerID</th>
      <th>BeginDate</th>
      <th>EndDate</th>
      <th>Type</th>
      <th>PaperlessBilling</th>
      <th>PaymentMethod</th>
      <th>MonthlyCharges</th>
      <th>TotalCharges</th>
      <th>MultipleLines</th>
      <th>OnlineSecurity</th>
      <th>OnlineBackup</th>
      <th>DeviceProtection</th>
      <th>TechSupport</th>
      <th>StreamingTV</th>
      <th>StreamingMovies</th>
      <th>FiberOptic</th>
      <th>SeniorCitizen</th>
      <th>Partner</th>
      <th>Dependents</th>
      <th>Woman</th>
      <th>IsClient</th>
      <th>AllTime</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7590-VHVEG</td>
      <td>2020-01-01</td>
      <td>2020-02-01</td>
      <td>Month-to-month</td>
      <td>1</td>
      <td>Electronic check</td>
      <td>29</td>
      <td>29</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5575-GNVDE</td>
      <td>2017-04-01</td>
      <td>2020-02-01</td>
      <td>One year</td>
      <td>0</td>
      <td>Mailed check</td>
      <td>56</td>
      <td>1889</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>34</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3668-QPYBK</td>
      <td>2019-10-01</td>
      <td>2019-12-01</td>
      <td>Month-to-month</td>
      <td>1</td>
      <td>Mailed check</td>
      <td>53</td>
      <td>108</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7795-CFOCW</td>
      <td>2016-05-01</td>
      <td>2020-02-01</td>
      <td>One year</td>
      <td>0</td>
      <td>Bank transfer (automatic)</td>
      <td>42</td>
      <td>1840</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>45</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9237-HQITU</td>
      <td>2019-09-01</td>
      <td>2019-11-01</td>
      <td>Month-to-month</td>
      <td>1</td>
      <td>Electronic check</td>
      <td>70</td>
      <td>151</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Index([&#39;customerID&#39;, &#39;BeginDate&#39;, &#39;EndDate&#39;, &#39;Type&#39;, &#39;PaperlessBilling&#39;,
       &#39;PaymentMethod&#39;, &#39;MonthlyCharges&#39;, &#39;TotalCharges&#39;, &#39;MultipleLines&#39;,
       &#39;OnlineSecurity&#39;, &#39;OnlineBackup&#39;, &#39;DeviceProtection&#39;, &#39;TechSupport&#39;,
       &#39;StreamingTV&#39;, &#39;StreamingMovies&#39;, &#39;FiberOptic&#39;, &#39;SeniorCitizen&#39;,
       &#39;Partner&#39;, &#39;Dependents&#39;, &#39;Woman&#39;, &#39;IsClient&#39;, &#39;AllTime&#39;],
      dtype=&#39;object&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;customerID&#39;</span><span class="p">,</span> <span class="s1">&#39;BeginDate&#39;</span><span class="p">,</span> <span class="s1">&#39;EndDate&#39;</span><span class="p">,</span><span class="s1">&#39;Partner&#39;</span><span class="p">,</span> <span class="s1">&#39;Woman&#39;</span><span class="p">,</span> <span class="s1">&#39;IsClient&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;IsClient&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 7043 entries, 0 to 7042
Data columns (total 16 columns):
 #   Column            Non-Null Count  Dtype 
---  ------            --------------  ----- 
 0   Type              7043 non-null   object
 1   PaperlessBilling  7043 non-null   int64 
 2   PaymentMethod     7043 non-null   object
 3   MonthlyCharges    7043 non-null   int64 
 4   TotalCharges      7043 non-null   int64 
 5   MultipleLines     7043 non-null   int64 
 6   OnlineSecurity    7043 non-null   int64 
 7   OnlineBackup      7043 non-null   int64 
 8   DeviceProtection  7043 non-null   int64 
 9   TechSupport       7043 non-null   int64 
 10  StreamingTV       7043 non-null   int64 
 11  StreamingMovies   7043 non-null   int64 
 12  FiberOptic        7043 non-null   int64 
 13  SeniorCitizen     7043 non-null   int64 
 14  Dependents        7043 non-null   int64 
 15  AllTime           7043 non-null   int64 
dtypes: int64(14), object(2)
memory usage: 935.4+ KB
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">encoder</span> <span class="o">=</span> <span class="n">OrdinalEncoder</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Type</th>
      <th>PaperlessBilling</th>
      <th>PaymentMethod</th>
      <th>MonthlyCharges</th>
      <th>TotalCharges</th>
      <th>MultipleLines</th>
      <th>OnlineSecurity</th>
      <th>OnlineBackup</th>
      <th>DeviceProtection</th>
      <th>TechSupport</th>
      <th>StreamingTV</th>
      <th>StreamingMovies</th>
      <th>FiberOptic</th>
      <th>SeniorCitizen</th>
      <th>Dependents</th>
      <th>AllTime</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>36.0</td>
      <td>1539.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>34.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>33.0</td>
      <td>89.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>22.0</td>
      <td>1503.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>45.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>50.0</td>
      <td>131.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
  <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">)</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">12345</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Type</th>
      <th>PaperlessBilling</th>
      <th>PaymentMethod</th>
      <th>MonthlyCharges</th>
      <th>TotalCharges</th>
      <th>MultipleLines</th>
      <th>OnlineSecurity</th>
      <th>OnlineBackup</th>
      <th>DeviceProtection</th>
      <th>TechSupport</th>
      <th>StreamingTV</th>
      <th>StreamingMovies</th>
      <th>FiberOptic</th>
      <th>SeniorCitizen</th>
      <th>Dependents</th>
      <th>AllTime</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>10</td>
      <td>10</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>36</td>
      <td>1539</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>34</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>33</td>
      <td>89</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>22</td>
      <td>1503</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>45</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>50</td>
      <td>131</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Dummy-model">Dummy model<a class="anchor-link" href="#Dummy-model"> </a></h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">scorer_for_cv</span> <span class="o">=</span> <span class="n">make_scorer</span><span class="p">(</span><span class="n">roc_auc_score</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dummy_regr</span> <span class="o">=</span> <span class="n">DummyRegressor</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;constant&quot;</span><span class="p">,</span> <span class="n">constant</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">dummy_regr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">dummy_predict</span> <span class="o">=</span> <span class="n">dummy_regr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dummy_auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">dummy_predict</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;AUC-ROC =&quot;</span><span class="p">,</span> <span class="n">dummy_auc</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>AUC-ROC = 0.5
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Linear-regression">Linear regression<a class="anchor-link" href="#Linear-regression"> </a></h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_lr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>

<span class="n">param_grid</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;normalize&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]}]</span>
<span class="n">model_lr_cv</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">model_lr</span><span class="p">,</span>
                           <span class="n">scoring</span><span class="o">=</span><span class="n">scorer_for_cv</span><span class="p">,</span>
                           <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span>
                           <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">model_lr_cv</span> <span class="o">=</span> <span class="n">model_lr_cv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_lr_cv</span><span class="o">.</span><span class="n">best_score_</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.9134962791064755</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Random-forrest">Random forrest<a class="anchor-link" href="#Random-forrest"> </a></h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_rfr</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">()</span>

<span class="n">param_grid</span> <span class="o">=</span> <span class="p">[</span>
   <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:[</span><span class="mi">20</span><span class="p">],</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:[</span><span class="mi">12</span><span class="p">],</span> <span class="s1">&#39;random_state&#39;</span><span class="p">:[</span><span class="mi">12345</span><span class="p">]},</span>
  <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:[</span><span class="mi">50</span><span class="p">],</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:[</span><span class="mi">5</span><span class="p">],</span><span class="s1">&#39;random_state&#39;</span><span class="p">:[</span><span class="mi">12345</span><span class="p">]},</span>
  <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:[</span><span class="mi">50</span><span class="p">],</span><span class="s1">&#39;max_depth&#39;</span><span class="p">:[</span><span class="mi">50</span><span class="p">],</span> <span class="s1">&#39;random_state&#39;</span><span class="p">:[</span><span class="mi">12345</span><span class="p">]}]</span>


<span class="n">model_rfr_cv</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">model_rfr</span><span class="p">,</span>
                          <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span>
                           <span class="n">scoring</span><span class="o">=</span><span class="n">scorer_for_cv</span><span class="p">,</span>
                          <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">model_rfr_cv</span> <span class="o">=</span> <span class="n">model_rfr_cv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_rfr_cv</span><span class="o">.</span><span class="n">best_score_</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.9228055321689848</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Gradient-boosting">Gradient boosting<a class="anchor-link" href="#Gradient-boosting"> </a></h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> 
                  <span class="n">y_train</span><span class="p">,</span> 
                  <span class="n">cat_features</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;PaperlessBilling&#39;</span><span class="p">,</span>  <span class="s1">&#39;TotalCharges&#39;</span><span class="p">,</span> <span class="s1">&#39;MultipleLines&#39;</span><span class="p">,</span> <span class="s1">&#39;MonthlyCharges&#39;</span><span class="p">,</span><span class="s1">&#39;AllTime&#39;</span><span class="p">,</span> 
                  <span class="s1">&#39;OnlineSecurity&#39;</span><span class="p">,</span> <span class="s1">&#39;OnlineBackup&#39;</span><span class="p">,</span> <span class="s1">&#39;DeviceProtection&#39;</span><span class="p">,</span> <span class="s1">&#39;TechSupport&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;StreamingTV&#39;</span><span class="p">,</span> <span class="s1">&#39;StreamingMovies&#39;</span><span class="p">,</span> <span class="s1">&#39;FiberOptic&#39;</span><span class="p">,</span> <span class="s1">&#39;SeniorCitizen&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Dependents&#39;</span><span class="p">])</span> 
<span class="n">model_CatBoostRegressor</span> <span class="o">=</span> <span class="n">CatBoostRegressor</span><span class="p">(</span><span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;AUC&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">param_grid</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span><span class="s1">&#39;iterations&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="s1">&#39;depth&#39;</span><span class="p">:[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">]}]</span>

<span class="n">model_cb_cv</span> <span class="o">=</span> <span class="n">model_CatBoostRegressor</span><span class="o">.</span><span class="n">grid_search</span><span class="p">(</span><span class="n">param_grid</span><span class="p">,</span> 
                                                   <span class="n">X</span><span class="o">=</span><span class="n">train_pool</span><span class="p">,</span>
                                                   <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Output" data-close="Show Output"></summary>
        <p>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
bestTest = 0.8371061337
bestIteration = 4

Metric AUC is not calculated on train by default. To calculate this metric on train, add hints=skip_train~false to metric parameters.
0:	loss: 0.8371061	best: 0.8371061 (0)	total: 76.8ms	remaining: 615ms

bestTest = 0.8401220378
bestIteration = 6

Metric AUC is not calculated on train by default. To calculate this metric on train, add hints=skip_train~false to metric parameters.
1:	loss: 0.8401220	best: 0.8401220 (1)	total: 102ms	remaining: 358ms

bestTest = 0.8451820289
bestIteration = 14

Metric AUC is not calculated on train by default. To calculate this metric on train, add hints=skip_train~false to metric parameters.
2:	loss: 0.8451820	best: 0.8451820 (2)	total: 316ms	remaining: 633ms

bestTest = 0.826336716
bestIteration = 3

Metric AUC is not calculated on train by default. To calculate this metric on train, add hints=skip_train~false to metric parameters.
3:	loss: 0.8263367	best: 0.8451820 (2)	total: 374ms	remaining: 468ms

bestTest = 0.8264395044
bestIteration = 8

Metric AUC is not calculated on train by default. To calculate this metric on train, add hints=skip_train~false to metric parameters.
4:	loss: 0.8264395	best: 0.8451820 (2)	total: 475ms	remaining: 380ms

bestTest = 0.8264395044
bestIteration = 8

Metric AUC is not calculated on train by default. To calculate this metric on train, add hints=skip_train~false to metric parameters.
5:	loss: 0.8264395	best: 0.8451820 (2)	total: 1.7s	remaining: 852ms

bestTest = 0.8060803992
bestIteration = 1

Metric AUC is not calculated on train by default. To calculate this metric on train, add hints=skip_train~false to metric parameters.
6:	loss: 0.8060804	best: 0.8451820 (2)	total: 3.31s	remaining: 945ms

bestTest = 0.8060803992
bestIteration = 1

Metric AUC is not calculated on train by default. To calculate this metric on train, add hints=skip_train~false to metric parameters.
7:	loss: 0.8060804	best: 0.8451820 (2)	total: 5.42s	remaining: 678ms

bestTest = 0.8060803992
bestIteration = 1

Metric AUC is not calculated on train by default. To calculate this metric on train, add hints=skip_train~false to metric parameters.
8:	loss: 0.8060804	best: 0.8451820 (2)	total: 34.2s	remaining: 0us
Estimating final quality...
</pre>
</div>
</div>

</div>
</div>
</p>
    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The best parameters is&quot;</span><span class="p">,</span> <span class="n">model_cb_cv</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>The best parameters is {&#39;depth&#39;: 5, &#39;learning_rate&#39;: 1, &#39;iterations&#39;: 100}
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_cb_cv</span> <span class="o">=</span> <span class="n">CatBoostRegressor</span><span class="p">(</span><span class="n">iterations</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> 
                                        <span class="n">learning_rate</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;AUC&#39;</span><span class="p">)</span>
<span class="n">model_cb_cv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_pool</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Output" data-close="Show Output"></summary>
        <p>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>0:	total: 3.66ms	remaining: 363ms
1:	total: 6ms	remaining: 294ms
2:	total: 8.94ms	remaining: 289ms
3:	total: 11.6ms	remaining: 279ms
4:	total: 13.9ms	remaining: 264ms
5:	total: 16.3ms	remaining: 255ms
6:	total: 18.7ms	remaining: 248ms
7:	total: 21ms	remaining: 242ms
8:	total: 23.4ms	remaining: 237ms
9:	total: 25.7ms	remaining: 231ms
10:	total: 28.1ms	remaining: 227ms
11:	total: 30.4ms	remaining: 223ms
12:	total: 32.7ms	remaining: 219ms
13:	total: 34.9ms	remaining: 215ms
14:	total: 37.2ms	remaining: 211ms
15:	total: 39.4ms	remaining: 207ms
16:	total: 41.6ms	remaining: 203ms
17:	total: 44.2ms	remaining: 201ms
18:	total: 46.5ms	remaining: 198ms
19:	total: 48.7ms	remaining: 195ms
20:	total: 51ms	remaining: 192ms
21:	total: 53.3ms	remaining: 189ms
22:	total: 55.6ms	remaining: 186ms
23:	total: 57.9ms	remaining: 183ms
24:	total: 60.6ms	remaining: 182ms
25:	total: 63ms	remaining: 179ms
26:	total: 65.5ms	remaining: 177ms
27:	total: 67.9ms	remaining: 175ms
28:	total: 70.3ms	remaining: 172ms
29:	total: 72.6ms	remaining: 169ms
30:	total: 75.1ms	remaining: 167ms
31:	total: 77.3ms	remaining: 164ms
32:	total: 79.8ms	remaining: 162ms
33:	total: 82.1ms	remaining: 159ms
34:	total: 84.5ms	remaining: 157ms
35:	total: 86.9ms	remaining: 155ms
36:	total: 89.3ms	remaining: 152ms
37:	total: 91.7ms	remaining: 150ms
38:	total: 94ms	remaining: 147ms
39:	total: 96.4ms	remaining: 145ms
40:	total: 98.7ms	remaining: 142ms
41:	total: 101ms	remaining: 140ms
42:	total: 103ms	remaining: 137ms
43:	total: 106ms	remaining: 135ms
44:	total: 108ms	remaining: 132ms
45:	total: 111ms	remaining: 130ms
46:	total: 113ms	remaining: 127ms
47:	total: 115ms	remaining: 125ms
48:	total: 118ms	remaining: 123ms
49:	total: 120ms	remaining: 120ms
50:	total: 123ms	remaining: 118ms
51:	total: 125ms	remaining: 116ms
52:	total: 128ms	remaining: 113ms
53:	total: 130ms	remaining: 111ms
54:	total: 132ms	remaining: 108ms
55:	total: 135ms	remaining: 106ms
56:	total: 137ms	remaining: 103ms
57:	total: 140ms	remaining: 101ms
58:	total: 142ms	remaining: 98.7ms
59:	total: 144ms	remaining: 96.2ms
60:	total: 147ms	remaining: 93.8ms
61:	total: 149ms	remaining: 91.3ms
62:	total: 151ms	remaining: 89ms
63:	total: 154ms	remaining: 86.5ms
64:	total: 156ms	remaining: 84.1ms
65:	total: 159ms	remaining: 81.7ms
66:	total: 161ms	remaining: 79.2ms
67:	total: 167ms	remaining: 78.4ms
68:	total: 169ms	remaining: 76ms
69:	total: 172ms	remaining: 73.5ms
70:	total: 176ms	remaining: 72ms
71:	total: 182ms	remaining: 70.9ms
72:	total: 186ms	remaining: 68.8ms
73:	total: 190ms	remaining: 66.6ms
74:	total: 195ms	remaining: 65ms
75:	total: 197ms	remaining: 62.3ms
76:	total: 200ms	remaining: 59.6ms
77:	total: 202ms	remaining: 57ms
78:	total: 204ms	remaining: 54.3ms
79:	total: 207ms	remaining: 51.7ms
80:	total: 209ms	remaining: 49ms
81:	total: 211ms	remaining: 46.4ms
82:	total: 214ms	remaining: 43.8ms
83:	total: 216ms	remaining: 41.1ms
84:	total: 218ms	remaining: 38.5ms
85:	total: 221ms	remaining: 35.9ms
86:	total: 223ms	remaining: 33.3ms
87:	total: 225ms	remaining: 30.7ms
88:	total: 228ms	remaining: 28.1ms
89:	total: 230ms	remaining: 25.5ms
90:	total: 232ms	remaining: 23ms
91:	total: 235ms	remaining: 20.4ms
92:	total: 237ms	remaining: 17.8ms
93:	total: 239ms	remaining: 15.3ms
94:	total: 242ms	remaining: 12.7ms
95:	total: 244ms	remaining: 10.2ms
96:	total: 246ms	remaining: 7.62ms
97:	total: 249ms	remaining: 5.08ms
98:	total: 251ms	remaining: 2.54ms
99:	total: 254ms	remaining: 0us
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;catboost.core.CatBoostRegressor at 0x7ff9bcacaed0&gt;</pre>
</div>

</div>

</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Test-the-model"><strong>Test the model</strong><a class="anchor-link" href="#Test-the-model"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Linear-regression"><strong>Linear regression</strong><a class="anchor-link" href="#Linear-regression"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model_lr_cv</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">lr_auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;AUC-ROC =&quot;</span><span class="p">,</span> <span class="n">lr_auc</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>AUC-ROC = 0.8293950540785984
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Random-forrest"><strong>Random forrest</strong><a class="anchor-link" href="#Random-forrest"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model_rfr_cv</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">rfr_auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;AUC-ROC =&quot;</span><span class="p">,</span> <span class="n">rfr_auc</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>AUC-ROC = 0.8531534101154354
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="CatBoostClassifier"><strong>CatBoostClassifier</strong><a class="anchor-link" href="#CatBoostClassifier"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> 
                  <span class="n">cat_features</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;PaperlessBilling&#39;</span><span class="p">,</span> <span class="s1">&#39;MonthlyCharges&#39;</span><span class="p">,</span> <span class="s1">&#39;TotalCharges&#39;</span><span class="p">,</span> <span class="s1">&#39;MultipleLines&#39;</span><span class="p">,</span>
       <span class="s1">&#39;OnlineSecurity&#39;</span><span class="p">,</span> <span class="s1">&#39;OnlineBackup&#39;</span><span class="p">,</span> <span class="s1">&#39;DeviceProtection&#39;</span><span class="p">,</span> <span class="s1">&#39;TechSupport&#39;</span><span class="p">,</span>
       <span class="s1">&#39;StreamingTV&#39;</span><span class="p">,</span> <span class="s1">&#39;StreamingMovies&#39;</span><span class="p">,</span> <span class="s1">&#39;FiberOptic&#39;</span><span class="p">,</span> <span class="s1">&#39;SeniorCitizen&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dependents&#39;</span><span class="p">,</span> <span class="s1">&#39;AllTime&#39;</span><span class="p">])</span> 
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model_cb_cv</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_pool</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>

<span class="n">cbc_auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;AUC-ROC =&quot;</span><span class="p">,</span> <span class="n">cbc_auc</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[0.88648241 0.46205313 0.10287211 ... 0.79784994 1.16184092 1.02592976]
AUC-ROC = 0.8272001088456784
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Solution-Report"><strong>Solution Report</strong><a class="anchor-link" href="#Solution-Report"> </a></h1><ul>
<li>Question: What steps of the plan were performed and what steps were skipped (explain why)? </li>
<li>Answer: It was no need to skip any steps in the plan, so all steps were performed. </li>
</ul>
<hr />
<ul>
<li>Question: What difficulties did you encounter and how did you manage to solve them?</li>
<li>Answer: The difficult and unsucceded part was to increase the AUC-ROC metric more than 0.88. </li>
</ul>
<hr />
<ul>
<li>Question: What were some of the key steps to solving the task?</li>
<li>Answer: The key steps were to prepare data for model training and to find the best hyperparameters. </li>
</ul>
<hr />
<ul>
<li>Question: What is your final model and what quality score does it have?</li>
<li>Answer: The Random Forest model gave the best result - it's AUC-ROC metric has value 0,853. It is the best model to predict the churn of clients. </li>
</ul>

</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/ds_projects/2021/03/10/_Practicum-Final-Project.ipynb.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/ds_projects/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/ds_projects/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/ds_projects/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Welcome to the Data Science blog by Kritina Pluzharova</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/pluzharovakp" title="pluzharovakp"><svg class="svg-icon grey"><use xlink:href="/ds_projects/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
